<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Share Config</title>

    <link rel="icon" href="/images/favicon.png" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
        };
    </script>
    <style>
        /* Custom animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        .slide-in {
            animation: slideIn 0.4s ease-out;
        }

        .pulse-gentle {
            animation: pulse 2s infinite;
        }

        .backdrop-blur-glass {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3);
        }

        .gradient-border {
            background: linear-gradient(45deg, #3B82F6, #8B5CF6, #06B6D4);
            padding: 2px;
            border-radius: 12px;
        }

        .glass-morphism {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-gray-100 min-h-screen">
<!-- Home Button -->
<div class="fixed top-4 left-4 z-50">
    <button
            onclick="goHome()"
            class="group bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white p-3 rounded-full shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 glass-morphism"
            title="Go Home"
    >
        <svg class="w-6 h-6 transition-transform duration-300 group-hover:rotate-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
        </svg>
    </button>
</div>

<div class="container mx-auto px-4 py-8 max-w-5xl">
    <!-- Loading state -->
    <div id="loading" class="text-center py-20">
        <div class="relative">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"></div>
            <div class="absolute inset-0 inline-block animate-ping rounded-full h-12 w-12 border-2 border-blue-400 opacity-20"></div>
        </div>
        <p class="mt-6 text-gray-400 text-lg">Loading amazing content...</p>
    </div>

    <!-- Content container -->
    <div id="content" class="hidden">
        <!-- Title -->
        <div class="text-center mb-12 fade-in-up">
            <h1 id="page-title" class="text-5xl md:text-6xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent mb-4 leading-tight"></h1>
            <div class="w-24 h-1 bg-gradient-to-r from-blue-500 to-purple-500 mx-auto rounded-full"></div>
        </div>

        <!-- Content -->
        <div class="mb-16 fade-in-up">
            <div class="gradient-border slide-in">
                <div
                        id="page-content"
                        class="bg-gray-800 rounded-lg p-8 text-lg leading-relaxed text-gray-300 whitespace-pre-line max-w-4xl mx-auto text-center shadow-2xl"
                ></div>
            </div>
        </div>

        <!-- Slideshow Container -->
        <div id="slideshow-container" class="relative max-w-4xl mx-auto mb-8 slide-in">
            <div class="gradient-border">
                <div class="bg-gray-800 rounded-lg overflow-hidden shadow-2xl">
                    <!-- Image Display -->
                    <div class="relative h-96 md:h-[500px] flex items-center justify-center">
                        <img
                                id="slideshow-image"
                                src=""
                                alt="Slideshow Image"
                                class="w-full h-full object-cover transition-all duration-700 ease-in-out transform"
                                style="display: none;"
                        />

                        <!-- Image Error State -->
                        <div id="image-error" class="hidden absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center">
                            <div class="text-gray-400 text-center fade-in-up">
                                <svg class="w-20 h-20 mx-auto mb-4 pulse-gentle" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 00-2-2H6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                <p class="text-xl">Image failed to load</p>
                            </div>
                        </div>

                        <!-- No Images State -->
                        <div id="no-images" class="hidden absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center">
                            <div class="text-gray-400 text-center fade-in-up">
                                <svg class="w-20 h-20 mx-auto mb-4 pulse-gentle" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 00-2-2H6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                                <p class="text-xl">No images available</p>
                            </div>
                        </div>
                    </div>

                    <!-- Image Counter -->
                    <div id="image-counter" class="absolute top-4 left-4 backdrop-blur-glass text-white px-4 py-2 rounded-full text-sm font-medium" style="display: none;">
                        <span id="current-image">1</span> / <span id="total-images">1</span>
                    </div>

                    <!-- Dots Indicator -->
                    <div id="dots-container" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 flex space-x-3" style="display: none;">
                        <!-- Dots will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Slideshow Controls (Mobile-friendly) -->
        <div id="mobile-controls" class="flex justify-center mt-8 space-x-6 fade-in-up" style="display: none;">
            <button
                    onclick="previousImage()"
                    class="bg-gradient-to-r from-gray-700 to-gray-600 hover:from-blue-600 hover:to-purple-600 text-white px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105"
            >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="font-medium">Previous</span>
            </button>
            <button
                    onclick="nextImage()"
                    class="bg-gradient-to-r from-gray-700 to-gray-600 hover:from-blue-600 hover:to-purple-600 text-white px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105"
            >
                <span class="font-medium">Next</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Error state -->
    <div id="error" class="hidden text-center py-20">
        <div class="fade-in-up">
            <div class="text-red-400 text-2xl mb-6 pulse-gentle">⚠️ Oops! Something went wrong</div>
            <p id="error-message" class="text-gray-400 mb-8 text-lg max-w-md mx-auto"></p>
            <button
                    onclick="loadContent()"
                    class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-4 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 font-medium"
            >
                Try Again
            </button>
        </div>
    </div>
</div>

<script>
    let images = [];
    let currentImageIndex = 0;

    function goHome() {
        // You can change this to your actual home URL
        window.location.href = '/home';
    }

    async function loadContent() {
        try {
            showLoading();

            const path = window.location.pathname;
            const parts = path.split('/');
            const id = parts.pop() || parts.pop(); // Handles trailing slash

            if (!id) {
                showError('No configuration ID found in the URL path.');
                return;
            }

            const API_URL = `/api/config/${id}`;

            const response = await fetch(API_URL, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();

            if (!data.title || !data.content || !Array.isArray(data.images)) {
                throw new Error('Invalid data structure received from API');
            }

            displayContent(data);
        } catch (error) {
            console.error('Error loading content:', error);
            showError(error.message);
        }
    }

    function displayContent(data) {
        document.getElementById('page-title').textContent = data.title;
        document.getElementById('page-content').textContent = data.content;

        images = data.images || [];
        currentImageIndex = 0;

        if (images.length > 0) {
            setupSlideshow();
            displayCurrentImage();
        } else {
            showNoImages();
        }

        showContent();
    }

    function setupSlideshow() {
        const hasMultipleImages = images.length > 1;

        document.getElementById('image-counter').style.display = 'block';
        document.getElementById('mobile-controls').style.display = hasMultipleImages ? 'flex' : 'none';

        document.getElementById('total-images').textContent = images.length;
        generateDots();

        // Remove existing event listener before adding new one
        document.removeEventListener('keydown', handleKeyboardNavigation);
        document.addEventListener('keydown', handleKeyboardNavigation);
    }

    function generateDots() {
        const dotsContainer = document.getElementById('dots-container');
        dotsContainer.innerHTML = '';

        if (images.length <= 1) {
            dotsContainer.style.display = 'none';
            return;
        }

        dotsContainer.style.display = 'flex';

        images.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.className = `w-3 h-3 rounded-full transition-all duration-300 transform hover:scale-125 ${
                index === currentImageIndex
                    ? 'bg-blue-500 shadow-lg shadow-blue-500/50'
                    : 'bg-gray-400 hover:bg-gray-300'
            }`;
            dot.onclick = () => goToImage(index);
            dotsContainer.appendChild(dot);
        });
    }

    function displayCurrentImage() {
        if (images.length === 0) return;

        const img = document.getElementById('slideshow-image');
        const errorDiv = document.getElementById('image-error');

        img.style.display = 'none';
        img.style.opacity = '0';
        errorDiv.classList.add('hidden');

        document.getElementById('current-image').textContent = currentImageIndex + 1;

        img.onload = () => {
            img.style.display = 'block';
            setTimeout(() => {
                img.style.opacity = '1';
            }, 50);
        };

        img.onerror = () => {
            img.style.display = 'none';
            errorDiv.classList.remove('hidden');
        };

        img.src = images[currentImageIndex];
        updateDots();
    }

    function updateDots() {
        const dots = document.querySelectorAll('#dots-container button');
        dots.forEach((dot, index) => {
            dot.className = `w-3 h-3 rounded-full transition-all duration-300 transform hover:scale-125 ${
                index === currentImageIndex
                    ? 'bg-blue-500 shadow-lg shadow-blue-500/50'
                    : 'bg-gray-400 hover:bg-gray-300'
            }`;
        });
    }

    function nextImage() {
        if (images.length <= 1) return;
        currentImageIndex = (currentImageIndex + 1) % images.length;
        displayCurrentImage();
    }

    function previousImage() {
        if (images.length <= 1) return;
        currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
        displayCurrentImage();
    }

    function goToImage(index) {
        if (index >= 0 && index < images.length) {
            currentImageIndex = index;
            displayCurrentImage();
        }
    }

    function handleKeyboardNavigation(event) {
        if (images.length <= 1) return;

        switch(event.key) {
            case 'ArrowLeft':
                event.preventDefault();
                previousImage();
                break;
            case 'ArrowRight':
                event.preventDefault();
                nextImage();
                break;
        }
    }

    function showNoImages() {
        document.getElementById('no-images').classList.remove('hidden');
        document.getElementById('slideshow-image').style.display = 'none';
    }

    function showLoading() {
        document.getElementById('loading').classList.remove('hidden');
        document.getElementById('content').classList.add('hidden');
        document.getElementById('error').classList.add('hidden');
    }

    function showContent() {
        document.getElementById('loading').classList.add('hidden');
        document.getElementById('content').classList.remove('hidden');
        document.getElementById('error').classList.add('hidden');
    }

    function showError(message = 'Failed to load the page content. Please try again later.') {
        document.getElementById('loading').classList.add('hidden');
        document.getElementById('content').classList.add('hidden');
        document.getElementById('error').classList.remove('hidden');
        document.getElementById('error-message').textContent = message;
    }

    document.addEventListener('DOMContentLoaded', loadContent);
</script>
</body>
</html>
